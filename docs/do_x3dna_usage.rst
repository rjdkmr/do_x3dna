.. |3DNA package| raw:: html

    <a href="http://www.x3dna.org" target="_blank">3DNA package</a>

How to use GROMACS do_x3dna ?
=============================

It is the wrapper tool, which uses |3DNA package| to calculate several structural
descriptors of DNA/RNA from the GROMACS MD trajectory. It executes 3DNA tools to
calculate these descriptors and subsequently, extracts these output and saves in to
external `output files <http://do-x3dna.readthedocs.io/en/latest/do_x3dna_usage.html#output-files>`_
as a function of time.

.. warning::
   DSSR-X3DNA is incompatible with do_x3dna. Please use original 3DNA packacge. 
   This could be dowloaded from by `3DNA forum <http://forum.x3dna.org/site-announcements/download-instructions/>`_.

* ``do_x3dna`` tool can be used with trajectory file generated by any Gromacs version.
  However, **tpr** file is supported depending on the version (either 4.5.x or 4.6.x
  or 5.0.x or 5.1.x or 2016.x) used during the installation.
* In case of other versions or other programs such as NAMD and AMBER, **PDB** file
  can be used in place of **tpr** file.
* Trajectories from NAMD and AMBER should be converted to Gromacs compatible formats such as trr, xtc, pdb etc.

**Execute following command to get full help**
::

    do_x3dna -h


.. note::
   To execute do_x3dna, |3DNA package| should be installed and ``$X3DNA`` environment variable (Detail is given in 3DNA manual) should be defined.

.. warning::
    Before running do_x3dna, make sure 3DNA package is correctly working for the input DNA/RNA structure.
    To check it, run do_x3dna with a input gro/pdb file containing only one frame instead of xtc/trr trajectory
    file as follows: ::

        do_x3dna -s topol.tpr -f check.gro -n index.ndx -noisy

    ``-noisy`` option enables the display of output messages raised by 3DNA tools
    (``find_pair`` and ``analyze``), and these messages would be necessary to troubleshoot
    problems related to the 3DNA package. Most common problem is the mismatch of residue names
    in input DNA/RNA structure and 3DNA package dictionary.


.. warning::
    Only PBC corrected trajectory and tpr files should be used as inputs. PBC corrected
    PDB/GRO file can be used in place of tpr file. Index file **SHOULD BE** used to
    select ONLY DNA/RNA in the input trajectory file.



Options
-------

::

    Option     Filename  Type         Description
    ------------------------------------------------------------
      -f       traj.xtc  Input        Trajectory: xtc trr trj gro g96 pdb cpt
      -s      topol.tpr  Input        Structure+mass(db): tpr tpb tpa gro g96 pdb
      -n      index.ndx  Input, Opt.  Index file
      -o   BP_count.xvg  Output       xvgr/xmgr file
    -map     BP_map.xpm  Output, Opt. X PixMap compatible matrix file
      -g        map.log  Output, Opt. Log file

    Option       Type   Value   Description
    ------------------------------------------------------
    -[no]h       bool   yes     Print help info and quit
    -[no]version bool   no      Print version info and quit
    -nice        int    19      Set the nicelevel
    -b           time   0       First frame (ps) to read from trajectory
    -e           time   0       Last frame (ps) to read from trajectory
    -dt          time   0       Only use frame when t MOD dt = first time (ps)
    -tu          enum   ps      Time unit: fs, ps, ns, us, ms or s
    -xvg         enum   xmgrace  xvg plot formatting: xmgrace, xmgr or none
    -[no]noisy   bool   no      Generate information from the X3DNA package
    -[no]hbond   bool   no      Hydrogen bond map for base pairs
    -[no]ref     bool   no      Base pair parameters will be calculated from base pair of the reference frame
    -name        string g       Output file names will be suffixed by this word after "_"
    -[no]fit     bool   yes     Fitting frames on reference structure
    -[no]mwa     bool   yes     Mass weighted fitting
    -[no]lbpm    bool   no      To calculate local base pair parameters
    -[no]lbpsm   bool   no      To calculate local base-pair step parameters
    -[no]lbphm   bool   no      To calculate local base-pair helical parameters
    -[no]avg     bool   yes     Average and Standard Deviation over all the frames
    -[no]c       bool   no      Output structural parameters between helical regions ("----" by default). It will invoke "-c" option with 3DNA analyze command.





``-ref``
~~~~~~~~
If ``-ref`` option is used, all structural descriptors are calculated on the basis
of the structure of the DNA/RNA present in the input tpr/pdb file, which is provided
with ``-s`` option. ``-ref`` option **SHOULD BE** used if output files are further
used as input files in `dnaMD <dnaMD_usage.html>`_ or `dnaMD module <api_summary.html>`_.
To analyze the formation or breaking of base-pairs during MD simulations, either ``-noref``
could be used or do not include ``-ref`` option because this option is switched-off by default.

``-fit``
~~~~~~~~
If ``-fit`` is enabled, the structure of DNA/RNA is fitted on the reference structure,
which is provided with ``-s`` option. During fitting procedure, DNA/RNA is translated
to origin such that its center of mass is located at the origin. Most of the parameters
are unaffected by this fitting procedure, however co-ordinates of the local helical axis
could mismatch with the input structure of the DNA/RNA.

``-hbond``
~~~~~~~~~~
To extracts hydrogen bonds for each base pair. A map.log ( ``-g`` ) file
is generated containing the base pair information as per index of the hydrogen
bond map ( ``-map`` ).

``-lbpm``
~~~~~~~~~
To calculate Local Base Pair Parameters (Shear, Stretch, Stagger, Buckle, Propeller
and Opening) with function of time, and average (with ``-avg`` ) of these parameters
with function of the base-pairs. ``-lbpm`` option calculates Local Base Pair Parameters
(Shear, Stretch, Stagger, Buckle, Propeller and Opening) with function of time, and
average (with ``-avg`` ) of these parameters with function of the base-pairs.

``-lbpsm``
~~~~~~~~~~
To calculate Local Base Pair-Step Parameters (Shift, Slide, Rise, Tilt, Roll and
Twist) with function of time, and average (with ``-avg`` ) of these parameters with
function of the base-steps. ``-lbpsm`` option calculates Local Base Pair-Step Parameters
(Shift, Slide, Rise, Tilt, Roll and Twist) with function of time, and average (with ``-avg`` )
of these parameters with function of the base-steps.

``-lbphm``
~~~~~~~~~~
To calculate Local Base Pair-Helical Parameters (X-displacement, Y-displacement,
H-rise, Inclination, Tip and H-twist) with function of time, and average (with ``-avg`` )
of these parameters with function of the base-steps. ``-lbphm`` option calculates
Local Base Pair-Helical Parameters (X-displacement, Y-displacement, H-rise, Inclination,
Tip and H-twist) with function of time, and average (with ``-avg`` ) of these parameters
with function of the base-steps.

``-c``
~~~~~~
3DNA generates outputs for base-pairs/steps that form the double-helix. However, some nucleotides
might not be the part of the double helix. To calculate of these mis-matched nucleotides, ``-c``
option can be used.


.. note::
    Apart from the above parameters, following parameters are calculated using 3DNA package
    for each frame and written in separate files as a function of time.

      * local helical axis
      * major and minor grooves
      * local helical radius
      * backbone dihedral angles (``alpha``, ``beta``, ``gamma``, ``delta``, ``epsilon``, ``zeta`` and ``chi``)
      * sugar dihedral angles (``v0``, ``v1``, ``v2``, ``v3`` and ``v4``)

    These files are listed below.


Output Files
------------

Following files are generated from ``do_x3dna`` with and without options:

.. list-table:: List of output files from do_x3dna
    :widths: 1, 4
    :header-rows: 1
    :name: output-files-table

    * - File name
      - Output contents

    * - base_pairs_g.dat
      - Base-pairs

    * - h-bond_g.dat
      - Hydrogen bonds between base-pairs

    * - L-BP_g.dat
      - Base-pairs parameters

    * - L-BPS_g.dat
      - Base-steps parameters

    * - L-BPH_g.dat
      - Helical Base-steps parameters

    * - HelAxis_g.dat
      - Local helical axis coordinates

    * - MGroove_g.dat
      - Major and Minor grooves

    * - HelixRad_g.dat
      - Local helical radius

    * - BackBoneCHiDihedrals_g.dat
      - Backbone dihedral angles including Chi-dihedral

    * - SugarDihedrals_g.dat
      - Sugar dihedral angles including puckering type

    * - Stretch_g.xvg
      - Stretch of base-pairs as a function of time

    * - Shear_g.xvg
      - Shear of base-pairs as a function of time

    * - Stagger_g.xvg
      - Stagger of base-pairs as a function of time

    * - Buckle_g.xvg
      - Buckle of base-pairs as a function of time

    * - Propeller_g.xvg
      - Propeller of base-pairs as a function of time

    * - Opening_g.xvg
      - Opening of base-pairs as a function of time

    * - Shift_g.xvg
      - Shift of base-steps as a function of time

    * - Slide_g.xvg
      - Slide of base-steps as a function of time

    * - Rise_g.xvg
      - Rise of base-steps as a function of time

    * - Tilt_g.xvg
      - Tilt of base-steps as a function of time

    * - Roll_g.xvg
      - Roll of base-steps as a function of time

    * - Twist_g.xvg
      - Twist of base-steps as a function of time

    * - X-displacement_g.xvg
      - Helical X-displacement of helical base-steps as a function of time

    * - Y-displacement_g.xvg
      - Helical Y-displacement of base-steps as a function of time

    * - Tip_g.xvg
      - Tip of base-steps as a function of time

    * - Inclination_g.xvg
      - Helical inclination of base-steps as a function of time

    * - H-twist_g.xvg
      - Helical twist of helical base-steps as a function of time

    * - H-rise_g.xvg
      - Helical rise of base-steps as a function of time

    * - Avg_Local_BP_param_g.xvg
      - Average and standard deviations of Base-pairs parameters with respect to base-pairs

    * - Avg_bp_step_param_g.xvg
      - Average and standard deviations of Base-steps parameters with respect to base-steps

    * - Avg_bp_helical_param_g.xvg
      - Average and standard deviations of helical Base-steps parameters with respect to base-steps                                                      |


Name of these files could be change by setting different suffix instead of ``g`` using ``-name`` option. These
files could be used with the Python APIs or scripts for further analysis.
